[{"content":"\n本文代码已上传github，自取\nhttps://github.com/Bla1n/WBDmonitor 0x00 起因\n对于我这样一个假粉，想及时地收到喜欢明星的动态真的是太难了，靠APP的特别关注提醒也基本无济于事，除非我每天都打开微博，B站，抖音。但作为一名“热爱学习”的当代青年，以上这些APP能少看还是少看的好。这就是矛盾所在，也就产生了本文。（本文提供两种监控思路）\n0x01 第一种：微博获取文章id\n这里感谢奶权师傅的文章 提供的接口：https://m.weibo.cn/。经测试，现在访问已经不需要登陆，省去模拟登陆步骤。\n来看访问用户主页的请求\n最关键的为图中标红框的xhr\n请求一：https://m.weibo.cn/api/container/getIndex?uid=1927305954\u0026amp;t=0\u0026amp;luicode=10000011\u0026amp;lfid=100103type%3D1%26q%3D%E6%88%90%E6%9E%9C\u0026amp;sudaref=login.sina.com.cn\u0026amp;type=uid\u0026amp;value=1927305954\u0026amp;containerid=1005051927305954 请求二：https://m.weibo.cn/api/container/getIndex?uid=1927305954\u0026amp;t=0\u0026amp;luicode=10000011\u0026amp;lfid=100103type%3D1%26q%3D%E6%88%90%E6%9E%9C\u0026amp;sudaref=login.sina.com.cn\u0026amp;type=uid\u0026amp;value=1927305954\u0026amp;containerid=1076031927305954 经测试，请求一中uid参数为各用户专有且固定不变，containerid参数可不加，返回结果包含的containerid参数提供给请求二，其余参数可舍。\n请求二带上containerid参数即可返回微博内容，微博信息都在mblog数组内\n思路：\n1.先访问请求一获取containerid参数，拼接请求二。\n2访问请求二，匹配响应里所有mblog数组里的id值（每条动态对应一个专有id），并存储到文件中。\n3.定时访问，若发现新id值不在文件里，则视为新微博，推送微信消息。\n封装到类里，代码如下（代码显示太丑了，点击github连接查看）\nhttps://github.com/Bla1n/WBDmonitor/blob/main/monitor/wbmonitor.py 0x02 第二种：B站直接坐享其成\n原本打算B站直接延续上文思路，但在分析网页内容的时候我发现了一处有意思的地方\nhttps://space.bilibili.com/3345720/video 如图所示，B站已经统计好当前用户视频数了，那么我只要关注这个数字不就行了吗？\n分析请求发现是下面这条连接返回的视频数目，那么剩下的就很简单了\nhttps://api.bilibili.com/x/space/navnum?mid=3345720\u0026jsonp=jsonp\u0026callback= 思路：\n1.拼接api的url（mid参数为b站用户专有且固定不变）\n2.访问获取视频数目，存储到文件里\n3.定时访问，若视频数发生变化，则视为更新\nhttps://github.com/Bla1n/WBDmonitor/blob/main/monitor/bzmonitor.py 0x03 抖音监控（APP端）\n抖音与前两者不同，抖音只有APP端才能访问，这就要配合手机或者模拟器来分析（本文用的模拟器）\n查阅资料得知线索，打开抖音用户界面点击分享，里面的链接分享可供我们使用\nhttps://v.douyin.com/e1o7d17/ 分析数据包找到返回作品数的包\nhttps://www.iesdouyin.com/web/api/v2/user/info/?sec_uid=MS4wLjABAAAAnCz_s5xyosgWTo5lTxKCmoYX1-uiytDsAKBye1LbfDE sec_uid参数为用户专有参数\n剩下思路同上\nhttps://github.com/Bla1n/WBDmonitor/blob/main/monitor/dymonitor.py 0x04 推送程序\n各平台监控问题解决了，没有一个好的推送也是不行的。日常用的最多的是微信，并且微信来消息的话，提醒也会很明显。\n这里用到https://sre24.com/\n使用也很简单，微信扫描登陆获取token，根据文档的介绍写一个notify函数就可以用了\n0x05 启动程序\n不多赘述，看代码\nhttps://github.com/Bla1n/WBDmonitor/blob/main/start.py 0x06 定时任务\n奶权师傅文章里采用心跳包的方式，我这种不愿意挂后台的人就用的定时任务，\n如果服务器搭了宝塔可在后台直接设定，没有的用crontab设效果也是一样的\n0x07 使用效果\n代码已上传至github，使用方法详见readme\nhttps://github.com/Bla1n/WBDmonitor 0x08 填坑\n1.定时任务请将脚本内文件路径改为绝对路径\n2.推送没采用邮件最主要的原因是，我在Windows上测试没有问题，Linux发不出去（端口开启着没被占用，stmp服务似乎是正常的，未解决）\n3.抖音没有直接添加用户ID的选项，因为没有直接获取用户ID的方法，抓包需自己去抓。然后修改url里的sec_user_id参数也是一样的\n4.如果想要用邮箱功能把start.py里的注释去掉即可，注意一点，授权码不是邮箱密码，自行查找邮箱账户。\n哦对了，python3的email库需手动安装，详见Python3下email 安装报错 No module named \u0026lsquo;cStringIO\u0026rsquo; 5.兴趣是学习的第一推动力\n参考文章：\nPython系列之——利用Python实现微博监控 ","date":"2024-01-15T00:00:00Z","image":"https://www.blain.top/p/wbdmonitor/12.jpeg","permalink":"https://www.blain.top/p/wbdmonitor/","title":"微博，B站，抖音实时关(jian)注(kong)脚本分享"},{"content":" 正文测试 这是正文内容\n引用 思念是最暖的忧伤像一双翅膀\n让我停不了飞不远在过往游荡\n不告而别的你 就算为了我着想\n这么沉痛的呵护 我怎么能翱翔\n最暖的憂傷 - 田馥甄 图片 24px {{\u0026lt; test \u0026gt;}} code test 音乐列表 相册语法来自 Typlog ","date":"2024-01-02T00:00:00Z","image":"https://www.blain.top/p/test-chinese123/title.jpg","permalink":"https://www.blain.top/p/test-chinese123/","title":"Test"}]